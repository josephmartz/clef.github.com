<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Clef.github.com by Clef</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <link rel="stylesheet" href="stylesheets/prettify.css">
    <script type='text/javascript' src='javascripts/prettify.js'></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body onload='prettyPrint();'>
    <div class="wrapper">
      <header>
        <h1>Clef</h1>
        <p>Celf API Documentation</p>


        <p class="view"><a href="https://github.com/Clef">Visit the Clef GitHub Profile</a></p>
        </br>
        <p><a href='#sample'>Sample Applications</a></p>
        <p><a href='#tutorial'>Setup Clef on your website in 5 minutes</a></p>
        <p><a href='#documentation'>Documentation</a></p>

      </header>
      <section>
        <h1>Welcome to Clef</h1>
        </br>
        <p>Clef is a new way to manage identity on the web. Rather than remember hundreds of usernames and passwords, Clef makes authentication easy and secure. First, website owners integrate the Clef javascript API with their website. Next, users download the Clef mobile application on their phone and set up an account using only their email. Now, users can scan any login QR code on a Clef enabled site and they will instantly authenticate the entire computer. Finally, when users are ready, they can logout on their phone and the computer will be deactivatedâ€”allowing no new logins to Clef enabled sites.</p>
        
        <p>If you're here, you are almost certainly a website owner looking to integrate Clef with your website. Below, you'll find <a href='#tutorial'>a quick and easy tutorial</a> that will have users authenticating with Clef on your website in minutes! In addition, you can find <a href='#sample'>sample applications built using Clef in Ruby, Python, and Javascript</a> and <a href='#documentation'>in-depth documentation on the API</a></p>
        <div id='sample'>
          </br>
          </br>
          <h2>Sample applications using the Clef API</h2>
          </br>
          <p>To help with the development process, we've created some sample applications, which can be used as a basis for integrating Clef into your application. Right now, we have the following sample applications:</p>
          <ul>
            <li><a href='https://github.com/jpollak92/Clef-Sample/tree/master/ruby'>Ruby</a></li>
            <li><a href='#'>Python</a></li>
            <li><a href='#'>Node</a></li>
          </ul>
        </div>
        </br>
        </br>
        </br>
        <div id='tutorial'>
        </br>
        <h2>Setting Clef up on your website</h2>
        </br>
        <h3>1. Load the Clef SDK on your site</h3>
        <p>Loading the Clef.io SDK on your website is extremely easy. All you have to do is place a script tag at the bottom of your HTML head element:</p>
        <pre>
          <code class='prettyprint'>
&lt;head&gt;
  //all of your other things
  &lt;script src='http://clef.io/static/clef.js'&gt;&lt;/script&gt;
&lt;/head&gt;
          </code>
        </pre>

        <h3>2. Initialize Clef.io SDK and load the Clef.io login iFrame</h3>
        <p>With the SDK loaded, you can now initialize the iframe that users will use to authenticate. We recommend placing the initializer at the bottom of your body element.</p>
        <p>When you initialize the iframe, you must place a div on your site with a CSS ID and provide this ID in the <i>inside</i> field in the options. The QR code will be initialized inside of this div.</p>
        <pre>
          <code class='prettyprint'>
var clef = Clef("YOUR_APP_ID");
clef.initFrame({
  dim: '200', 
  inside: '#qrcode',
  redirect_url: YOUR_REDIRECT_URI
});
          </code>
        </pre>
        
        <h3>3. Prepare routes for user redirection</h3>
        <p>When the user authorizes your application, they will be redirected to your specified redirect_uri with an OAuth Code:</p>
        <pre>
          <code class='prettyprint'>
GET YOUR_REDIRECT_URL?
  code=CODE_GENERATED_BY_CLEF
          </code>
        </pre>
        <p>If the user did not authorize your application, they will be redirected to your specified redirect_uri with an error:</p>
        <pre>
          <code class='prettyprint'>
GET YOUR_REDIRECT_URL?
   error_reason=user_denied
  &amp;error=access_denied
  &amp;error_description=The+user+denied+your+request.
          </code>
        </pre>

        <h3>4. Exchange the OAuth code for an OAuth Access Token</h3>

        <p>Following OAuth 2.0 protocol, once the user has authorized your application, you must make a <b>server side request</b> to exchange the OAuth code generated by Clef.io for a user access token. For this request, you must pass your App ID, App Secret (found on your settings page), and the generated code.</p>
        <pre>
          <code class='prettyprint'>
GET http://clef.io/api/authorize?
   app_id=YOUR_APP_ID
  &amp;app_secret=YOUR_APP_SECRET
  &amp;code=CODE_GENERATED_BY_CLEF.
          </code>
        </pre>

        <p>The body of the response to this request will be JSON containing the access_token:</p>
        <pre>
          <code class='prettyprint'>
{
  access_token: 'USER_ACCESS_TOKEN'
}
          </code>
        </pre>
        <p>You should use this token to make requests to the Clef information API. You should also persist this access token in your database in order to make further requests to the API without having to re-authenticate the user.</p>

        <p>If there is an issue exchanging the code for a user access token, the authorization server will issue an HTTP 400 and return the error as a JSON object in the body of the response:</p>

        <pre>
          <code class='prettyprint'>
{
   "error": {
      "type": "OAuthException",
      "message": "Error validating verification code."
   }
}
          </code>
        </pre>

        <h3>5. Make a request to Clef API to get user information</h3>

        <p>Now that you have the access_token, you can make a request to the Clef API to get the user information. A common first request would be to get the basic information (including the id and name) of the user who just authenticated your app:<p>

        <pre>
          <code class='prettyprint'>
<span class='exp'>REQUEST DEFINITION:</span>

GET http://clef.io/api/info?access_token={YOUR_USER_ACCESS_TOKEN}

<span class='exp'>EXAMPLE REQUEST:</span>

ADD THIS

<span class='exp'>EXAMPLE RESPONSE:</span>

{
  {
    id: '12345',
    first_name: 'Jesse',
    last_name: 'Pollak',
    phone_number: '1234567890',
    email: 'jesse@clef.io'
  }
}
          </code>
        </pre>
        </div>
        
        </br>
        </br>
        <div id='documentation'>
          <h2>Clef API Documentation</h2>
          </br>
          </br>
          <h3>Javascript</h3>
          <p>The front end Clef javascript API is essential to Clef integration in your application. It <i>must</i> be included on any page you want users to be able to authenticate with Clef</p>
          <h4>Initialization</h4>
          <p>You must initialize the API on every page</p>
          <pre>
            <code class='prettyprint'>
var clef = Clef('APPLICATION_ID');
            </code>
          </pre>
          <h4>initFrame(options)</h4>
          <p>To generate the Clef QR code that allows users to authenticate, you must call the initFrame method</p>
          <pre>
            <code class='prettyprint'>
clef.initFrame({
  
  //your preferred width and height of the Clef iFrame; 
  //must be greater than 150 and an INTEGER
  dim: 200, 
  
  //a valid CSS ID of the div on your page that
  // you want the Clef QR code to appear in
  inside: '#qr', 
  
  //the url that you want users to be redirected to on authentication
  //on this page, you will exchange the OAuth code for a token
  //and request user information from the Clef API
  redirect_url: 'http://example.com/redirect' 
})
            </code>
          </pre>
          </br>
          <h3>OAuth</h3>
          <p>Clef follows the OAuth 2.0 protocol to authenticate users. Luckily, much of this protocol is abstracted away because of the unique phone to computer interaction Clef provides; therefore, all you need to do is implement the redirect URI and code for token exchange.</p>
          <h4>GET /authorize</h4>
          <p>This is the API route to exchange an OAuth code for an access token.</p>
          <pre>
            <code class='prettyprint'>
<span class='exp'>REQUEST DEFINITION:</span>

GET http://clef.io/api/authorize?
  access_token={YOUR_USER_ACCESS_TOKEN}
  &amp;app_id={YOUR_APP_ID}
  &amp;app_secret={YOUR_APP_SECRET}

<span class='exp'>EXAMPLE REQUEST:</span>

ADD THIS

<span class='exp'>EXAMPLE SUCCESS RESPONSE:</span>

{
  {
    access_token: '1234567'
  }
}

<span class='exp'>POSSIBLE ERROR RESPONSES:</span>

//provided app ID does not correspond to an application
{
  {
    error: 'Invalid App ID'
  }
}

//provided app secret is incorrect or not present
{
  {
    error: 'Invalid App Secret'
  }
}

//provided OAuth code is incorrect or not present
{
  {
    error: 'Invalid OAuth Code'
  }
}

                </code>
              </pre>
          </br>
          <h3>User Information</h3>
          <p>Right now, there is only one API route to get access about the user. In the future, Clef will support API calls to other services that the user can connect like Facebook, Twitter, or Instagram</p>
          <h4>GET /info</h4>
          <p>This API request returns all available information for the user.</p>
          
                  <pre>
                    <code class='prettyprint'>
<span class='exp'>REQUEST DEFINITION:</span>

GET http://clef.io/api/info?access_token={YOUR_USER_ACCESS_TOKEN}

<span class='exp'>EXAMPLE REQUEST:</span>

ADD THIS

<span class='exp'>EXAMPLE SUCCESS RESPONSE:</span>

{
  {
    id: '12345',
    first_name: 'Jesse',
    last_name: 'Pollak',
    phone_number: '1234567890',
    email: 'jesse@clef.io'
  }
}

<span class='exp'>POSSIBLE ERROR RESPONSES:</span>

//provided OAuth token is invalid or not present
{
  {
    error: 'Invalid token'
  }
}
                    </code>
                  </pre>
        </div>           
      </section>
      
      <footer>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>